#!/usr/bin/env ruby
#
# Script to convert ruby code into json output.
#
require_relative "../lib/srm"
require_relative "srm_spec_options"

opt = SrmSpecOptions.new(ARGV)


eval(File.new(opt.spec).read, binding, __FILE__, __LINE__)

klass = Kernel.const_get(opt.top)
inst = klass.new(name: "srm_root")

inst.nodes.each do |n|
  puts JSON.pretty_generate(n)
end


#!/usr/bin/env ruby
#
# Script to convert ruby code into json output.
#
require_relative "../lib/srm"
spec_file = "../tests/sap1_top.rb"
$LOAD_PATH << "../tests"
$LOAD_PATH << "../lib"

top = "Sap1"

eval(File.new(spec_file).read, binding, __FILE__, __LINE__)

klass = Kernel.const_get(top)
inst = klass.new(name: "srm_root")

inst.nodes.each do |n|
  puts JSON.pretty_generate(n)
end

